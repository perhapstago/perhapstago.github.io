{"version":3,"file":"index.js","sources":["../../src/node/locales.ts","../../src/node/utils.ts","../../src/node/alias.ts","../../src/node/compact.ts","../../src/node/options.ts","../../src/node/plugin.ts"],"sourcesContent":["import { type WalineLocaleConfig } from \"../shared/index.js\";\n\n/**\n * Default locale config for Waline\n */\nexport const walineLocales: WalineLocaleConfig = {\n  \"/en/\": {\n    placeholder:\n      \"Write a comment here (Fill in the email address to receive an email notification when being replied)\",\n  },\n\n  \"/zh/\": {\n    placeholder: \"请留言。(填写邮箱可在被回复时收到邮件提醒)\",\n  },\n\n  \"/zh-tw/\": {\n    placeholder: \"請留言。(填寫信箱可在被回覆時收到郵件提醒)\",\n  },\n\n  \"/de/\": {\n    placeholder:\n      \"Schreibe ein Kommentar (Geben Sie die E-Mail-Adresse ein, um eine E-Mail-Benachrichtigung zu erhalten, wenn Sie eine Antwort erhalten)\",\n  },\n\n  \"/de-at/\": {\n    placeholder:\n      \"Schreibe ein Kommentar (Geben Sie die E-Mail-Adresse ein, um eine E-Mail-Benachrichtigung zu erhalten, wenn Sie eine Antwort erhalten)\",\n  },\n\n  \"/vi/\": {\n    placeholder:\n      \"Để lại bình luận (Điền địa chỉ email để nhận email thông báo khi được trả lời)\",\n  },\n\n  \"/uk/\": {\n    placeholder:\n      \"Напишіть тут коментар (введіть адресу електронної пошти, щоб отримувати сповіщення електронною поштою, коли буде відповідь)\",\n  },\n\n  \"/ru/\": {\n    placeholder:\n      \"Напишите комментарий здесь (Введите адрес электронной почты, чтобы получить уведомление по электронной почте при ответе)\",\n  },\n\n  \"/br/\": {\n    placeholder:\n      \"Escreva um comentário aqui (preencha com o endereço de email para receber notificações quando tiver alguma resposta)\",\n  },\n\n  \"/pl/\": {\n    placeholder:\n      \"Wpisz tutaj komentarz (wpisz adres e-mail, aby otrzymać powiadomienie e-mail, gdy otrzymasz odpowiedź)\",\n  },\n\n  \"/sk/\": {\n    placeholder:\n      \"Napíš svoj komentár (vlož svoj e-mail taktiež, aby si bol notifikovaný o odpovediach)\",\n  },\n\n  \"/fr/\": {\n    placeholder:\n      \"Écrivez votre commentaire ici (Inscrivez votre email afin de recevoir une notification en cas de réponse)\",\n  },\n\n  \"/es/\": {\n    placeholder:\n      \"Escriba un comentario aquí (Ingrese su correo electrónico para recibir una notificación en caso de respuesta)\",\n  },\n\n  \"/ja/\": {\n    placeholder:\n      \"伝言をどうぞ (メールアドレスを入力すると、返信があった際にメールでお知らせします。)\",\n  },\n\n  \"/tr/\": {\n    placeholder:\n      \"Buraya bir yorum yazın (Yanıtlandığında bir e-posta bildirimi almak için e-posta adresinizi girin)\",\n  },\n\n  \"/ko/\": {\n    placeholder:\n      \"댓글을 남겨주세요 (답변이 있을 경우 이메일로 알림을 받으려면 이메일 주소를 입력하세요)\",\n  },\n\n  \"/fi/\": {\n    placeholder:\n      \"Kirjoita kommentti tähän (täytä sähköpostiosoite saadaksesi sähköposti-ilmoituksen vastauksesta)\",\n  },\n  \"/hu/\": {\n    placeholder:\n      \"Írj kommentet itt! (Töltsd ki az email címet, hogy értesítést kapj, amikor válaszolnak.)\",\n  },\n};\n","import { ensureEndingSlash } from \"@vuepress/shared\";\nimport { getDirname, path } from \"@vuepress/utils\";\nimport { Logger } from \"vuepress-shared/node\";\n\nconst __dirname = getDirname(import.meta.url);\n\nexport const CLIENT_FOLDER = ensureEndingSlash(\n  path.resolve(__dirname, \"../client\")\n);\n\nexport const COMMENT_PROVIDERS = [\"Artalk\", \"Giscus\", \"Waline\", \"Twikoo\"];\n\nexport const logger = new Logger(\"vuepress-plugin-comment2\");\n","import { noopModule } from \"vuepress-shared/node\";\n\nimport { CLIENT_FOLDER, COMMENT_PROVIDERS, logger } from \"./utils.js\";\n\nexport const getProvider = (provider = \"None\"): string => {\n  if (COMMENT_PROVIDERS.includes(provider))\n    return `${CLIENT_FOLDER}components/${provider}.js`;\n\n  if (provider !== \"None\") logger.error(`Invalid provider: ${provider}`);\n\n  return noopModule;\n};\n","import { logger } from \"./utils.js\";\nimport { type CommentOptions } from \"../shared/index.js\";\n\n/** @deprecated */\nexport const convertOptions = (\n  options: CommentOptions & {\n    /** @deprecated */\n    type?: \"waline\" | \"giscus\" | \"twikoo\" | \"none\";\n  }\n): void => {\n  // v2 changes\n  if (\"type\" in options) {\n    logger.warn(`\"type\" is deprecated, please use \"provider\".`);\n\n    if (options[\"type\"] === \"waline\") options.provider = \"Waline\";\n    else if (options[\"type\"] === \"giscus\") options.provider = \"Giscus\";\n    else if (options[\"type\"] === \"twikoo\") options.provider = \"Twikoo\";\n\n    delete options[\"type\"];\n  }\n\n  // convert Waline options\n  if (options.provider === \"Waline\") {\n    [\n      // valine\n      [\"emojiCDN\", \"emoji\"],\n      [\"emojiMaps\", \"emoji\"],\n      [\"requiredFields\", \"requiredMeta\"],\n      [\"visitor\", \"pageview\"],\n      [\"langMode\", \"locale\"],\n      [\"placeholder\", \"locale.placeholder\"],\n\n      // waline v1\n      [\"anonymous\", \"login\"],\n      [\"copyRight\", \"copyright\"],\n    ].forEach(([oldOptions, newOptions]) => {\n      if (oldOptions in options) {\n        logger.warn(\n          `\"${oldOptions}\" is deprecated in @waline/client@v2, you should use \"${newOptions}\" instead.`\n        );\n\n        // @ts-ignore\n        delete options[oldOptions];\n      }\n    });\n\n    [\n      // valine\n      \"region\",\n      \"appId\",\n      \"appKey\",\n      \"notify\",\n      \"verify\",\n      \"avatar\",\n      \"avatarForce\",\n      \"enableQQ\",\n      \"recordIP\",\n      \"serverURLs\",\n\n      // waline v1\n      \"avatarCDN\",\n      \"mathTagSupport\",\n      \"highlight\",\n      \"uploadImage\",\n      \"previewMath\",\n    ].forEach((option) => {\n      if (option in options) {\n        logger.error(\n          `\"${option}\" is no longer supported in @waline/client@v2.`\n        );\n\n        // @ts-ignore\n        delete options[option];\n      }\n    });\n  }\n};\n","import { type App } from \"@vuepress/core\";\nimport { colors } from \"@vuepress/utils\";\n\nimport { COMMENT_PROVIDERS, logger } from \"./utils.js\";\nimport { type CommentOptions } from \"../shared/index.js\";\n\nexport const applyDemo = (options: CommentOptions, app: App): void => {\n  const { isDev } = app.env;\n\n  options.provider =\n    options.provider && COMMENT_PROVIDERS.includes(options.provider)\n      ? options.provider\n      : \"None\";\n\n  switch (options.provider) {\n    case \"Artalk\":\n      if (!options.server)\n        if (isDev) {\n          logger.info(\n            `A fallback Artalk server is used ${colors.red(\n              \"for demo only\"\n            )}. You should provide ${colors.magenta(\n              \"server\"\n            )} option yourself in production.`\n          );\n\n          options.site = \"artalk-demo\";\n          options.server = \"https://demo-artalk.jjdxb.top/\";\n        } else {\n          logger.error(`${colors.magenta(\"site\")} is required for Artalk.`);\n        }\n\n      break;\n\n    case \"Giscus\":\n      if (\n        !options.repo &&\n        !options.repoId &&\n        !options.category &&\n        !options.categoryId &&\n        isDev\n      ) {\n        logger.info(\n          `A fallback GitHub repo is used ${colors.red(\n            \"for demo only\"\n          )}. You should provide ${colors.magenta(\"repo\")}, ${colors.magenta(\n            \"repoId\"\n          )}, ${colors.magenta(\"category\")} and ${colors.magenta(\n            \"categoryId\"\n          )} option yourself in production.`\n        );\n\n        options.repo = \"vuepress-theme-hope/giscus-discussions\";\n        options.repoId = \"R_kgDOG_Pt2A\";\n        options.category = \"Announcements\";\n        options.categoryId = \"DIC_kwDOG_Pt2M4COD69\";\n      } else {\n        if (!options.repo)\n          logger.error(`${colors.magenta(\"repo\")} is required for Giscus.`);\n        if (!options.repoId)\n          logger.error(`${colors.magenta(\"repoId\")} is required for Giscus.`);\n        if (!options.category)\n          logger.error(`${colors.magenta(\"category\")} is required for Giscus.`);\n        if (!options.categoryId)\n          logger.error(\n            `${colors.magenta(\"categoryId\")} is required for Giscus.`\n          );\n      }\n\n      break;\n\n    case \"Waline\":\n      if (!options.serverURL)\n        if (isDev) {\n          options.serverURL = \"https://waline-comment.vuejs.press\";\n\n          logger.info(\n            `A fallback Waline server is used ${colors.red(\n              \"for demo only\"\n            )}. You should provide ${colors.magenta(\n              \"serverURL\"\n            )} option yourself in production.`\n          );\n        } else {\n          logger.error(\n            `${colors.magenta(\"serverURL\")} is required for Waline.`\n          );\n        }\n\n      break;\n\n    case \"Twikoo\":\n      if (!options.envId)\n        if (isDev) {\n          logger.info(\n            `A fallback Twikoo server is used ${colors.red(\n              \"for demo only\"\n            )}. You should provide ${colors.magenta(\n              \"envId\"\n            )} option yourself in production.`\n          );\n\n          options.envId = \"https://twikoo.ccknbc.vercel.app\";\n        } else {\n          logger.error(`${colors.magenta(\"envId\")} is required for Twikoo.`);\n        }\n\n      break;\n  }\n};\n","import { type PluginFunction } from \"@vuepress/core\";\nimport { getDirname, path } from \"@vuepress/utils\";\nimport { useSassPalettePlugin } from \"vuepress-plugin-sass-palette\";\nimport {\n  addCustomElement,\n  addViteOptimizeDepsExclude,\n  addViteOptimizeDepsInclude,\n  addViteSsrExternal,\n  getLocales,\n} from \"vuepress-shared/node\";\n\nimport { getProvider } from \"./alias.js\";\nimport { convertOptions } from \"./compact.js\";\nimport { walineLocales } from \"./locales.js\";\nimport { applyDemo } from \"./options.js\";\nimport { logger } from \"./utils.js\";\nimport { type CommentOptions } from \"../shared/index.js\";\n\nconst __dirname = getDirname(import.meta.url);\n\n/** Comment Plugin */\nexport const commentPlugin =\n  (options: CommentOptions, legacy = true): PluginFunction =>\n  (app) => {\n    // TODO: Remove this in v2 stable\n    if (legacy)\n      convertOptions(options as CommentOptions & Record<string, unknown>);\n    if (app.env.isDebug) logger.info(\"Options:\", options);\n\n    applyDemo(options, app);\n\n    const userWalineLocales =\n      options.provider === \"Waline\"\n        ? getLocales({\n            app,\n            name: \"waline\",\n            default: walineLocales,\n            config: options.locales,\n          })\n        : {};\n\n    // remove locales so that they won’t be injected in client twice\n    if (options.provider === \"Waline\" && \"locales\" in options)\n      delete options.locales;\n\n    useSassPalettePlugin(app, { id: \"hope\" });\n\n    return {\n      name: \"vuepress-plugin-comment2\",\n\n      alias: {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        \"vuepress-plugin-comment2/provider\": getProvider(options.provider),\n      },\n\n      define: () => ({\n        COMMENT_OPTIONS: options,\n        ...(options.provider === \"Waline\"\n          ? {\n              WALINE_LOCALES: userWalineLocales,\n              WALINE_META: options.metaIcon !== false,\n            }\n          : {}),\n      }),\n\n      extendsBundlerOptions: (bundlerOptions: unknown, app): void => {\n        switch (options.provider) {\n          case \"Artalk\": {\n            addViteOptimizeDepsInclude(bundlerOptions, app, \"artalk\");\n            addViteSsrExternal(bundlerOptions, app, \"artalk\");\n            break;\n          }\n\n          case \"Giscus\": {\n            addCustomElement(bundlerOptions, app, \"GiscusWidget\");\n            addViteSsrExternal(bundlerOptions, app, \"giscus\");\n            break;\n          }\n\n          case \"Waline\": {\n            addViteOptimizeDepsInclude(bundlerOptions, app, \"autosize\");\n            addViteOptimizeDepsExclude(bundlerOptions, app, \"@waline/client\");\n            addViteSsrExternal(bundlerOptions, app, \"@waline/client\");\n            break;\n          }\n\n          case \"Twikoo\": {\n            addViteOptimizeDepsInclude(bundlerOptions, app, \"twikoo\");\n            addViteSsrExternal(bundlerOptions, app, \"twikoo\");\n            break;\n          }\n        }\n      },\n\n      clientConfigFile: path.resolve(__dirname, \"../client/config.js\"),\n    };\n  };\n"],"names":["walineLocales","__dirname","getDirname","CLIENT_FOLDER","ensureEndingSlash","path","COMMENT_PROVIDERS","logger","Logger","getProvider","provider","noopModule","convertOptions","options","oldOptions","newOptions","option","applyDemo","app","isDev","colors","commentPlugin","legacy","userWalineLocales","getLocales","useSassPalettePlugin","bundlerOptions","addViteOptimizeDepsInclude","addViteSsrExternal","addCustomElement","addViteOptimizeDepsExclude"],"mappings":"wXAKO,MAAMA,EAAoC,CAC/C,OAAQ,CACN,YACE,sGACJ,EAEA,OAAQ,CACN,YAAa,wBACf,EAEA,UAAW,CACT,YAAa,wBACf,EAEA,OAAQ,CACN,YACE,wIACJ,EAEA,UAAW,CACT,YACE,wIACJ,EAEA,OAAQ,CACN,YACE,gFACJ,EAEA,OAAQ,CACN,YACE,6HACJ,EAEA,OAAQ,CACN,YACE,0HACJ,EAEA,OAAQ,CACN,YACE,sHACJ,EAEA,OAAQ,CACN,YACE,wGACJ,EAEA,OAAQ,CACN,YACE,uFACJ,EAEA,OAAQ,CACN,YACE,2GACJ,EAEA,OAAQ,CACN,YACE,+GACJ,EAEA,OAAQ,CACN,YACE,6CACJ,EAEA,OAAQ,CACN,YACE,oGACJ,EAEA,OAAQ,CACN,YACE,mDACJ,EAEA,OAAQ,CACN,YACE,kGACJ,EACA,OAAQ,CACN,YACE,0FACJ,CACF,ECxFMC,EAAYC,EAAW,YAAY,GAAG,EAE/BC,EAAgBC,EAC3BC,EAAK,QAAQJ,EAAW,WAAW,CACrC,EAEaK,EAAoB,CAAC,SAAU,SAAU,SAAU,QAAQ,EAE3DC,EAAS,IAAIC,EAAO,0BAA0B,ECR9CC,EAAc,CAACC,EAAW,SACjCJ,EAAkB,SAASI,CAAQ,EAC9B,GAAGP,eAA2BO,QAEnCA,IAAa,QAAQH,EAAO,MAAM,qBAAqBG,GAAU,EAE9DC,GCNIC,EACXC,GAIS,CAEL,SAAUA,IACZN,EAAO,KAAK,8CAA8C,EAEtDM,EAAQ,OAAY,SAAUA,EAAQ,SAAW,SAC5CA,EAAQ,OAAY,SAAUA,EAAQ,SAAW,SACjDA,EAAQ,OAAY,WAAUA,EAAQ,SAAW,UAE1D,OAAOA,EAAQ,MAIbA,EAAQ,WAAa,WACvB,CAEE,CAAC,WAAY,OAAO,EACpB,CAAC,YAAa,OAAO,EACrB,CAAC,iBAAkB,cAAc,EACjC,CAAC,UAAW,UAAU,EACtB,CAAC,WAAY,QAAQ,EACrB,CAAC,cAAe,oBAAoB,EAGpC,CAAC,YAAa,OAAO,EACrB,CAAC,YAAa,WAAW,CAC3B,EAAE,QAAQ,CAAC,CAACC,EAAYC,CAAU,IAAM,CAClCD,KAAcD,IAChBN,EAAO,KACL,IAAIO,0DAAmEC,aACzE,EAGA,OAAOF,EAAQC,CAAU,EAE7B,CAAC,EAED,CAEE,SACA,QACA,SACA,SACA,SACA,SACA,cACA,WACA,WACA,aAGA,YACA,iBACA,YACA,cACA,aACF,EAAE,QAASE,GAAW,CAChBA,KAAUH,IACZN,EAAO,MACL,IAAIS,iDACN,EAGA,OAAOH,EAAQG,CAAM,EAEzB,CAAC,EAEL,ECtEaC,EAAY,CAACJ,EAAyBK,IAAmB,CACpE,KAAM,CAAE,MAAAC,CAAM,EAAID,EAAI,IAOtB,OALAL,EAAQ,SACNA,EAAQ,UAAYP,EAAkB,SAASO,EAAQ,QAAQ,EAC3DA,EAAQ,SACR,OAEEA,EAAQ,SAAU,CACxB,IAAK,SACEA,EAAQ,SACPM,GACFZ,EAAO,KACL,oCAAoCa,EAAO,IACzC,eACF,yBAAyBA,EAAO,QAC9B,QACF,kCACF,EAEAP,EAAQ,KAAO,cACfA,EAAQ,OAAS,kCAEjBN,EAAO,MAAM,GAAGa,EAAO,QAAQ,MAAM,2BAA2B,GAGpE,MAEF,IAAK,SAED,CAACP,EAAQ,MACT,CAACA,EAAQ,QACT,CAACA,EAAQ,UACT,CAACA,EAAQ,YACTM,GAEAZ,EAAO,KACL,kCAAkCa,EAAO,IACvC,eACF,yBAAyBA,EAAO,QAAQ,MAAM,MAAMA,EAAO,QACzD,QACF,MAAMA,EAAO,QAAQ,UAAU,SAASA,EAAO,QAC7C,YACF,kCACF,EAEAP,EAAQ,KAAO,yCACfA,EAAQ,OAAS,eACjBA,EAAQ,SAAW,gBACnBA,EAAQ,WAAa,yBAEhBA,EAAQ,MACXN,EAAO,MAAM,GAAGa,EAAO,QAAQ,MAAM,2BAA2B,EAC7DP,EAAQ,QACXN,EAAO,MAAM,GAAGa,EAAO,QAAQ,QAAQ,2BAA2B,EAC/DP,EAAQ,UACXN,EAAO,MAAM,GAAGa,EAAO,QAAQ,UAAU,2BAA2B,EACjEP,EAAQ,YACXN,EAAO,MACL,GAAGa,EAAO,QAAQ,YAAY,2BAChC,GAGJ,MAEF,IAAK,SACEP,EAAQ,YACPM,GACFN,EAAQ,UAAY,qCAEpBN,EAAO,KACL,oCAAoCa,EAAO,IACzC,eACF,yBAAyBA,EAAO,QAC9B,WACF,kCACF,GAEAb,EAAO,MACL,GAAGa,EAAO,QAAQ,WAAW,2BAC/B,GAGJ,MAEF,IAAK,SACEP,EAAQ,QACPM,GACFZ,EAAO,KACL,oCAAoCa,EAAO,IACzC,eACF,yBAAyBA,EAAO,QAC9B,OACF,kCACF,EAEAP,EAAQ,MAAQ,oCAEhBN,EAAO,MAAM,GAAGa,EAAO,QAAQ,OAAO,2BAA2B,GAGrE,KACJ,CACF,EC3FMnB,EAAYC,EAAW,YAAY,GAAG,EAG/BmB,EACX,CAACR,EAAyBS,EAAS,KAClCJ,GAAQ,CAEHI,GACFV,EAAeC,CAAmD,EAChEK,EAAI,IAAI,SAASX,EAAO,KAAK,WAAYM,CAAO,EAEpDI,EAAUJ,EAASK,CAAG,EAEtB,MAAMK,EACJV,EAAQ,WAAa,SACjBW,EAAW,CACT,IAAAN,EACA,KAAM,SACN,QAASlB,EACT,OAAQa,EAAQ,OAClB,CAAC,EACD,CAAA,EAGN,OAAIA,EAAQ,WAAa,UAAY,YAAaA,GAChD,OAAOA,EAAQ,QAEjBY,EAAqBP,EAAK,CAAE,GAAI,MAAO,CAAC,EAEjC,CACL,KAAM,2BAEN,MAAO,CAEL,oCAAqCT,EAAYI,EAAQ,QAAQ,CACnE,EAEA,OAAQ,KAAO,CACb,gBAAiBA,EACjB,GAAIA,EAAQ,WAAa,SACrB,CACE,eAAgBU,EAChB,YAAaV,EAAQ,WAAa,EACpC,EACA,CAAA,CACN,GAEA,sBAAuB,CAACa,EAAyBR,IAAc,CAC7D,OAAQL,EAAQ,SACd,CAAA,IAAK,SAAU,CACbc,EAA2BD,EAAgBR,EAAK,QAAQ,EACxDU,EAAmBF,EAAgBR,EAAK,QAAQ,EAChD,KACF,CAEA,IAAK,SAAU,CACbW,EAAiBH,EAAgBR,EAAK,cAAc,EACpDU,EAAmBF,EAAgBR,EAAK,QAAQ,EAChD,KACF,CAEA,IAAK,SAAU,CACbS,EAA2BD,EAAgBR,EAAK,UAAU,EAC1DY,EAA2BJ,EAAgBR,EAAK,gBAAgB,EAChEU,EAAmBF,EAAgBR,EAAK,gBAAgB,EACxD,KACF,CAEA,IAAK,SAAU,CACbS,EAA2BD,EAAgBR,EAAK,QAAQ,EACxDU,EAAmBF,EAAgBR,EAAK,QAAQ,EAChD,KACF,CACF,CACF,EAEA,iBAAkBb,EAAK,QAAQJ,EAAW,qBAAqB,CACjE,CACF"}